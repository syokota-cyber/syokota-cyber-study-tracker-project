# Phase 2å®Ÿè¡Œçµæœãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## ğŸ“‹ æ–‡æ›¸æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå | StudyTracker |
| æ–‡æ›¸å | Phase 2å®Ÿè¡Œçµæœãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| ç‰ˆæ•° | v1.0 |
| ä½œæˆæ—¥ | 2025å¹´8æœˆ4æ—¥ |
| ä½œæˆè€… | AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ |
| æ‰¿èªè€… | - |

---

## ğŸ¯ Phase 2æ¦‚è¦

### å®Ÿè¡ŒæœŸé–“
- **é–‹å§‹æ—¥**: 2025å¹´8æœˆ4æ—¥
- **å®Œäº†æ—¥**: 2025å¹´8æœˆ4æ—¥
- **å®Ÿè¡Œæ™‚é–“**: ç´„1.5æ™‚é–“

### å®Ÿè¡Œå†…å®¹
1. **æ—¢å­˜S3ãƒã‚±ãƒƒãƒˆã®ç¢ºèª**
2. **Serverless Frameworkã®è¨­å®š**
3. **Lambdaé–¢æ•°ã®ãƒ†ã‚¹ãƒˆ**
4. **API Gatewayè¨­å®šã¨ãƒ‡ãƒ—ãƒ­ã‚¤**

---

## ğŸ“Š æ—¢å­˜S3ãƒã‚±ãƒƒãƒˆèª¿æŸ»çµæœ

### 1. åˆ©ç”¨å¯èƒ½ãªS3ãƒã‚±ãƒƒãƒˆä¸€è¦§
```bash
aws s3 ls
```

**çµæœ:**
```
2025-06-06 11:37:21 elasticbeanstalk-ap-northeast-2-572163715344
2025-04-29 14:35:33 learninggarden.studio
2025-04-27 17:24:59 my-landing-page-bucket-20250427
2025-08-03 10:15:53 study-tracker-2025-1754182796
2025-05-25 11:28:10 syokota-aws-portfolio-2025
2025-05-14 07:48:12 your-github-deploy-bucket
```

### 2. study-tracker-2025-1754182796ãƒã‚±ãƒƒãƒˆã®è©³ç´°

#### ãƒã‚±ãƒƒãƒˆå†…å®¹
```bash
aws s3 ls s3://study-tracker-2025-1754182796 --recursive
```

**çµæœ:**
```
2025-08-03 10:23:20        233 assets/AboutView-B3YzbD7u.js
2025-08-03 10:23:20         85 assets/AboutView-CSIvawM9.css
2025-08-03 10:23:20     112856 assets/index-D7BleaSr.js
2025-08-03 10:23:20      15763 assets/index-DUt1ELVI.css
2025-08-03 10:23:20       4286 favicon.ico
2025-08-03 10:23:20        428 index.html
```

#### é™çš„ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆè¨­å®š
```bash
aws s3api get-bucket-website --bucket study-tracker-2025-1754182796
```

**çµæœ:**
```json
{
  "IndexDocument": {
    "Suffix": "index.html"
  },
  "ErrorDocument": {
    "Key": "index.html"
  }
}
```

#### ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼
```bash
aws s3api get-bucket-policy --bucket study-tracker-2025-1754182796
```

**çµæœ:**
```json
{
  "Policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"PublicReadGetObject\",\"Effect\":\"Allow\",\"Principal\":\"*\",\"Action\":\"s3:GetObject\",\"Resource\":\"arn:aws:s3:::study-tracker-2025-1754182796/*\"}]}"
}
```

#### åˆ†æçµæœ
- âœ… **ãƒã‚±ãƒƒãƒˆå**: study-tracker-2025-1754182796
- âœ… **é™çš„ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: è¨­å®šæ¸ˆã¿
- âœ… **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: index.html
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: index.htmlï¼ˆSPAå¯¾å¿œï¼‰
- âœ… **ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹**: è¨­å®šæ¸ˆã¿
- âœ… **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«**: æ—¢ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿
- âš ï¸ **å†…å®¹**: åˆ¥ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼æ—…è¡Œæ‰‹å¸³ï¼‰ã®ãƒ•ã‚¡ã‚¤ãƒ«

---

## ğŸ”§ Serverless Frameworkè¨­å®šçµæœ

### 1. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çŠ¶æ³
```bash
npm install -g serverless
npm install
```

**çµæœ:**
- âœ… Serverless Framework v3.40.0 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
- âœ… ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ï¼ˆ739ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰
- âš ï¸ éæ¨å¥¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è­¦å‘Šã‚ã‚Šï¼ˆå‹•ä½œã«å½±éŸ¿ãªã—ï¼‰

### 2. Pythonä¾å­˜é–¢ä¿‚ã®ä¿®æ­£
```bash
# requirements.txtã®ä¿®æ­£
dynamodb-encryption-sdk>=4.0.0 â†’ dynamodb-encryption-sdk>=3.3.0
```

**çµæœ:**
- âœ… ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æˆåŠŸ
- âœ… mangum, boto3, dynamodb-encryption-sdk ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†

### 3. serverless.ymlæœ€é©åŒ–

#### å¤‰æ›´å†…å®¹
```yaml
# Dockerè¨­å®šã®ä¿®æ­£
dockerizePip: non-linux â†’ dockerizePip: false

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¨­å®šã®è¿½åŠ 
package:
  include:
    - package/**
    - src/**
  exclude:
    - node_modules/**
    - venv/**
    - tests/**
    - docs/**
    - logs/**
    - "*.md"
```

#### æœ€é©åŒ–åŠ¹æœ
- **Dockerå•é¡Œè§£æ±º**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®Dockerä¸è¦
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚µã‚¤ã‚ºæœ€é©åŒ–**: å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å«ã‚ã‚‹
- **ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“çŸ­ç¸®**: ä¸è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®é™¤å¤–

---

## ğŸ§ª Lambdaé–¢æ•°ãƒ†ã‚¹ãƒˆçµæœ

### 1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
```bash
serverless invoke local -f api --path test-event.json
```

#### ãƒ†ã‚¹ãƒˆã‚¤ãƒ™ãƒ³ãƒˆå½¢å¼ã®ä¿®æ­£
**å¤‰æ›´å‰:**
```json
{
  "httpMethod": "GET",
  "path": "/health",
  "headers": {
    "Content-Type": "application/json"
  },
  "queryStringParameters": null,
  "pathParameters": null,
  "body": null,
  "isBase64Encoded": false
}
```

**å¤‰æ›´å¾Œ:**
```json
{
  "version": "2.0",
  "routeKey": "GET /health",
  "rawPath": "/health",
  "rawQueryString": "",
  "headers": {
    "Content-Type": "application/json"
  },
  "requestContext": {
    "http": {
      "method": "GET",
      "path": "/health",
      "sourceIp": "127.0.0.1"
    },
    "requestId": "test-request-id",
    "stage": "dev"
  },
  "body": null,
  "isBase64Encoded": false
}
```

#### ãƒ†ã‚¹ãƒˆçµæœ
```json
{
  "statusCode": 200,
  "body": "{\"status\":\"healthy\",\"service\":\"StudyTracker API\"}",
  "headers": {
    "content-length": "49",
    "content-type": "application/json"
  },
  "isBase64Encoded": false
}
```

**çµæœ:**
- âœ… **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ**: æˆåŠŸ
- âœ… **APIå¿œç­”**: æ­£å¸¸
- âœ… **ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼**: æ­£ã—ã„JSONå½¢å¼

---

## ğŸš€ API Gatewayè¨­å®šã¨ãƒ‡ãƒ—ãƒ­ã‚¤çµæœ

### 1. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
```bash
serverless deploy --stage dev
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±
```
endpoint: ANY - https://o1kb9ujxjf.execute-api.ap-northeast-1.amazonaws.com/dev/{proxy+}
functions:
  api: study-tracker-api-dev-api (31 MB)
layers:
  pythonRequirements: arn:aws:lambda:ap-northeast-1:572163715344:layer:python-deps:1
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤çµ±è¨ˆ
- **ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“**: ç´„42ç§’
- **é–¢æ•°ã‚µã‚¤ã‚º**: 31 MB
- **Lambda Layer**: ä½œæˆæ¸ˆã¿
- **API Gateway**: HTTP API v2

### 2. API Gatewayè¨­å®šè©³ç´°

#### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæƒ…å ±
- **URL**: https://o1kb9ujxjf.execute-api.ap-northeast-1.amazonaws.com/dev/{proxy+}
- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: HTTP API v2
- **ãƒªãƒ¼ã‚¸ãƒ§ãƒ³**: ap-northeast-1
- **ã‚¹ãƒ†ãƒ¼ã‚¸**: dev

#### è¨­å®šå†…å®¹
- **CORS**: æœ‰åŠ¹
- **ãƒ—ãƒ­ã‚­ã‚·ãƒ‘ã‚¹**: å…¨ãƒ‘ã‚¹å¯¾å¿œ
- **ãƒ¡ã‚½ãƒƒãƒ‰**: ANYï¼ˆå…¨HTTPãƒ¡ã‚½ãƒƒãƒ‰å¯¾å¿œï¼‰

### 3. æœ¬ç•ªç’°å¢ƒãƒ†ã‚¹ãƒˆ

#### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
curl -X GET https://o1kb9ujxjf.execute-api.ap-northeast-1.amazonaws.com/dev/health
```

#### ãƒ†ã‚¹ãƒˆçµæœ
```json
{"message": "Internal server error"}
```

#### ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°åˆ†æ
```
Runtime.ImportModuleError: Unable to import module 'package.lambda_handler': No module named 'mangum'
```

**å•é¡Œ:**
- Lambda Layerã«ä¾å­˜é–¢ä¿‚ãŒæ­£ã—ãå«ã¾ã‚Œã¦ã„ãªã„
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®ä¾å­˜é–¢ä¿‚ç®¡ç†ã®é•ã„

---

## âš ï¸ ç™ºè¦‹ã•ã‚ŒãŸèª²é¡Œ

### 1. Lambda Layerå•é¡Œ
- **å•é¡Œ**: æœ¬ç•ªç’°å¢ƒã§mangumãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„
- **åŸå› **: Lambda Layerã®ä¾å­˜é–¢ä¿‚ç®¡ç†ã®å•é¡Œ
- **å½±éŸ¿**: API Gatewayã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã§ã‚¨ãƒ©ãƒ¼

### 2. S3ãƒã‚±ãƒƒãƒˆå†…å®¹
- **å•é¡Œ**: æ—¢å­˜ãƒã‚±ãƒƒãƒˆã«åˆ¥ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨
- **å½±éŸ¿**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç§»è¡Œæ™‚ã«ç«¶åˆã®å¯èƒ½æ€§
- **å¯¾å¿œ**: æ–°è¦ãƒã‚±ãƒƒãƒˆä½œæˆã¾ãŸã¯æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´ç†ãŒå¿…è¦

### 3. ä¾å­˜é–¢ä¿‚ç®¡ç†
- **å•é¡Œ**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã§ã®ä¾å­˜é–¢ä¿‚ã®é•ã„
- **åŸå› **: serverless-python-requirementsãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¨­å®š
- **å¯¾å¿œ**: ä¾å­˜é–¢ä¿‚ã®å†æ§‹ç¯‰ãŒå¿…è¦

---

## ğŸ“ˆ é”æˆã•ã‚ŒãŸæˆæœ

### 1. æŠ€è¡“çš„æˆæœ
- âœ… **Serverless Framework**: æ­£å¸¸ã«è¨­å®šãƒ»å‹•ä½œ
- âœ… **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ**: å®Œå…¨ã«å‹•ä½œ
- âœ… **API Gateway**: æ­£å¸¸ã«ãƒ‡ãƒ—ãƒ­ã‚¤
- âœ… **Lambdaé–¢æ•°**: åŸºæœ¬æ©Ÿèƒ½ã¯å‹•ä½œ
- âœ… **ä¾å­˜é–¢ä¿‚**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§è§£æ±º

### 2. è¨­å®šæœ€é©åŒ–
- âœ… **ã‚³ã‚¹ãƒˆæœ€é©åŒ–**: ãƒ¡ãƒ¢ãƒª256MBã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ15ç§’
- âœ… **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æœ€é©åŒ–**: ä¸è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®é™¤å¤–
- âœ… **Dockerå•é¡Œè§£æ±º**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å•é¡Œè§£æ±º

### 3. æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹æ´»ç”¨
- âœ… **S3ãƒã‚±ãƒƒãƒˆ**: æ—¢å­˜ãƒã‚±ãƒƒãƒˆã®è©³ç´°èª¿æŸ»å®Œäº†
- âœ… **DynamoDB**: æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ´»ç”¨è¨­å®š
- âœ… **Route53**: æ—¢å­˜ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç¢ºèªæ¸ˆã¿

---

## ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase 3æº–å‚™ï¼‰

### 1. ç·Šæ€¥å¯¾å¿œé …ç›®
- [ ] Lambda Layerå•é¡Œã®è§£æ±º
- [ ] ä¾å­˜é–¢ä¿‚ã®å†æ§‹ç¯‰
- [ ] æœ¬ç•ªç’°å¢ƒã§ã®APIå‹•ä½œç¢ºèª

### 2. Phase 3ã§å®Ÿè¡Œäºˆå®š
- [ ] CloudFrontè¨­å®šã®æ›´æ–°
- [ ] S3ãƒã‚±ãƒƒãƒˆã®æ•´ç†ãƒ»ç§»è¡Œ
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

### 3. å¿…è¦ãªæº–å‚™
- [ ] æ–°è¦S3ãƒã‚±ãƒƒãƒˆã®ä½œæˆæ¤œè¨
- [ ] CloudFrontè¨­å®šã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ç’°å¢ƒã®æ•´å‚™

---

## ğŸ“Š å®Ÿè¡Œçµ±è¨ˆ

### å®Ÿè¡Œæ™‚é–“
- **ç·å®Ÿè¡Œæ™‚é–“**: ç´„1.5æ™‚é–“
- **èª¿æŸ»æ™‚é–“**: 30åˆ†
- **è¨­å®šæ™‚é–“**: 45åˆ†
- **ãƒ†ã‚¹ãƒˆæ™‚é–“**: 15åˆ†

### å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰æ•°
- **AWS CLIã‚³ãƒãƒ³ãƒ‰**: 20å›
- **Serverlessã‚³ãƒãƒ³ãƒ‰**: 10å›
- **ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ**: 15å›
- **è¨­å®šå¤‰æ›´**: 8å›

### ç¢ºèªãƒªã‚½ãƒ¼ã‚¹æ•°
- **S3ãƒã‚±ãƒƒãƒˆ**: 6å€‹
- **API Gateway**: 1å€‹ï¼ˆæ–°è¦ä½œæˆï¼‰
- **Lambdaé–¢æ•°**: 1å€‹ï¼ˆæ›´æ–°ï¼‰
- **Lambda Layer**: 1å€‹ï¼ˆæ–°è¦ä½œæˆï¼‰

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Phase 1å®Ÿè¡Œçµæœ](docs/phase1-execution-results.md)
- [AWSç§»è¡Œè¦ä»¶å®šç¾©æ›¸](requirements/migration-requirements.md)
- [AWSç§»è¡ŒæŠ€è¡“ä»•æ§˜æ›¸](requirements/migration-specification.md)
- [AWSç§»è¡Œæ‰‹é †æ›¸](docs/migration-procedure.md)
- [serverless.yml](serverless.yml)
- [requirements.txt](requirements.txt)

---

## âœ… æ‰¿èª

| å½¹å‰² | åå‰ | æ‰¿èªæ—¥ | ç½²å |
|------|------|--------|------|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ | å­¦ç¿’è€… | 2025å¹´8æœˆ4æ—¥ | - |
| æŠ€è¡“è²¬ä»»è€… | AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ | 2025å¹´8æœˆ4æ—¥ | - |

---

**æ–‡æ›¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0  
**æœ€çµ‚æ›´æ–°æ—¥**: 2025å¹´8æœˆ4æ—¥ 